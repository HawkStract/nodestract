use capability IO { target: "stdout" }
use capability Sys { mode: "debug" }

module VaultTest

func main() {
    IO.print("--- TEST CRITTOGRAFIA AES-256 (Nonce Uniqueness) ---")
    
    // Creiamo due variabili con LO STESSO contenuto segreto
    vault pass1 = "my_secret_key"
    vault pass2 = "my_secret_key"
    
    IO.print("Analisi Memoria (Le stringhe criptate DEVONO essere diverse):")
    
    IO.print("1. Dump pass1:")
    Sys.memory_dump(pass1)
    
    IO.print("2. Dump pass2 (Stesso contenuto di pass1):")
    Sys.memory_dump(pass2)
    
    IO.print("--- Verifica Decrittazione ---")
    
    // Verifichiamo che, nonostante siano criptate diversamente,
    // il sistema le legga correttamente come identiche.
    
    if pass1 == pass2 {
        IO.print("SUCCESS: Le password decriptate coincidono.")
    } else {
        IO.print("FAIL: Errore di decrittazione.")
    }
    
    IO.print("Valore reale:", pass1)
}